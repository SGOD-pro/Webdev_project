<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="../public/stylesheets/root.css">
        <link rel="stylesheet" href="../public/stylesheets/utlis.css">
        <style>
            .app-form {
                height: fit-content;
                width: 50%;
                min-width: 414px;
                border: 1px solid var(--secondary-bg-color);
                color: var(--primary-text-color);
            }
        </style>
    </head>

    <body>
        <div class="app-form absolute rounded-4 p-2 top-50 start-50 translate-middle">
            <h2 class="text-md">New Appointment</h2>
            <span class="material-symbols-outlined absolute end-0 top-0 p-2">
                cancel
            </span>
            <form class="row g-3" data-bs-theme="dark" onsubmit="submit(event)">
                <div class="col-md-6">
                    <label for="fullname" class="form-label text-capitalize">paitent name</label>
                    <input type="text" class="form-control" id="fullname" name="fullname" required>
                </div>
                <div class="col-md-3">
                    <label for="age" class="form-label">Age</label>
                    <input type="number" class="form-control" id="age" name="age" required>
                </div>
                <div class="col-md-3">
                    <label for="gender" class="form-label">Gender</label>
                    <select id="gender" class="form-select" name="gender" required>
                        <option selected>Choose...</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Others">Others</option>
                    </select>
                </div>
                <div class="form-floating">
                    <textarea class="form-control text-sm" placeholder="Leave a comment here" id="issue" name="issue"
                        style="height: 150px; resize: none;" required></textarea>
                    <label for="issue" class=" ms-2">Your Issue</label>
                </div>
                <div class="col-12">
                    <button class="btn btn-primary flex items-center" id="submit-btn">Book<div
                            class="spinner-grow text-secondary" role="status">

                        </div></button>
                </div>
            </form>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
        <script>
            function submit(event) {
                event.preventDefault();
                const formData = new FormData(event.target);
                const doctorId = localStorage.getItem("id")
                if (!doctorId) {
                    alert("Doctor not found.")
                }
                const data = { ...jsonData, doctorId }
                const btn = document.getElementById("submit-btn")
                btn.innerHTML = "Booking..<div class='spinner-grow text-secondary' role='status'></div>"
                btn.setAttribute("disabled", true)
                axios.post("/user/newappointment", data)
                    .then(response => {
                        window.location = "/users/therapist"
                    }).catch(error => {
                        alert(error.message)
                    })

                    .finally(() => {
                        btn.removeAttribute("disabled")
                        btn.innerHTML = "Book"
                    })
            }
        </script>
    </body>

</html>